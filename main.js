(()=>{"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===_typeof(i)?i:String(i)),o)}var n,i}var e=function(){function Api(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Api),this.baseUrl=e,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(t=r.headers)&&void 0!==t?t:{})}}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Api,[{key:"handleResponse",value:function handleResponse(e){return e.ok?e.json():e.json().then((function(t){var r;return Promise.reject(null!==(r=t.error)&&void 0!==r?r:e.statusText)}))}},{key:"get",value:function get(e){return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(t)})).then(this.handleResponse)}}]),Api}();function events_typeof(e){return events_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},events_typeof(e)}function events_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function events_toPrimitive(e,t){if("object"!==events_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==events_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===events_typeof(i)?i:String(i)),o)}var n,i}var t=function(){function EventEmitter(){!function events_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventEmitter),this._events=new Map}return function events_createClass(e,t,r){return t&&events_defineProperties(e.prototype,t),r&&events_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(EventEmitter,[{key:"on",value:function on(e,t){var r;this._events.has(e)||this._events.set(e,new Set),null===(r=this._events.get(e))||void 0===r||r.add(t)}},{key:"off",value:function off(e,t){var r;this._events.has(e)&&(this._events.get(e).delete(t),0===(null===(r=this._events.get(e))||void 0===r?void 0:r.size)&&this._events.delete(e))}},{key:"emit",value:function emit(e,t){this._events.forEach((function(r,o){"*"===o&&r.forEach((function(r){return r({eventName:e,data:t})})),(o instanceof RegExp&&o.test(e)||o===e)&&r.forEach((function(e){return e(t)}))}))}},{key:"onAll",value:function onAll(e){this.on("*",e)}},{key:"offAll",value:function offAll(){this._events=new Map}},{key:"trigger",value:function trigger(e,t){var r=this;return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.emit(e,Object.assign(Object.assign({},o||{}),t||{}))}}}]),EventEmitter}();function presenter_typeof(e){return presenter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},presenter_typeof(e)}function presenter_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function presenter_toPrimitive(e,t){if("object"!==presenter_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==presenter_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===presenter_typeof(i)?i:String(i)),o)}var n,i}var r=function(){function WebLarekApi(e){!function presenter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WebLarekApi),this.API=e}return function presenter_createClass(e,t,r){return t&&presenter_defineProperties(e.prototype,t),r&&presenter_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(WebLarekApi,[{key:"productList",value:function productList(){return this.API.get("/product").then((function(e){return e.items}))}},{key:"productItem",value:function productItem(e){return this.API.get("/product/".concat(e)).then((function(e){return e}))}},{key:"orderProduct",value:function orderProduct(e){return this.API.post("/order",e)}}]),WebLarekApi}(),o="".concat("","/api/weblarek"),n="".concat("","/content/weblarek");function catalog_typeof(e){return catalog_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},catalog_typeof(e)}function catalog_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function catalog_toPrimitive(e,t){if("object"!==catalog_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==catalog_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===catalog_typeof(i)?i:String(i)),o)}var n,i}var i=function(){function Catalog(e){!function catalog_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Catalog),this.items=[],this.events=e}return function catalog_createClass(e,t,r){return t&&catalog_defineProperties(e.prototype,t),r&&catalog_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Catalog,[{key:"setItemList",value:function setItemList(e){this.items=Array.isArray(e)?e:[],this.events.emit("productList:changed",this.items)}},{key:"getItemList",value:function getItemList(){return this.items}},{key:"getItem",value:function getItem(e){return this.items.find((function(t){return t.id==e.id}))}}]),Catalog}();function order_typeof(e){return order_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},order_typeof(e)}function order_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function order_toPrimitive(e,t){if("object"!==order_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==order_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===order_typeof(i)?i:String(i)),o)}var n,i}var a=function(){function Order(e){!function order_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Order),this.items=[],this.order={payment:"",address:"",email:"",phone:"",total:0,items:[]},this.formErrors={},this.events=e}return function order_createClass(e,t,r){return t&&order_defineProperties(e.prototype,t),r&&order_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Order,[{key:"addProduct",value:function addProduct(e){this.hasProduct({id:e.id})||this.items.push(e)}},{key:"hasProduct",value:function hasProduct(e){return this.items.some((function(t){return t.id===e.id}))}},{key:"removeProduct",value:function removeProduct(e){var t=this.items.findIndex((function(t){return t.id==e.id}));-1!==t&&this.items.splice(t,1)}},{key:"getTotal",value:function getTotal(){return this.items.reduce((function(e,t){return e+Number(t.price)}),0)}},{key:"clearBascket",value:function clearBascket(){this.items=[]}},{key:"clearDataForm",value:function clearDataForm(){this.order.payment="",this.order.address="",this.order.email="",this.order.phone="",this.formErrors={}}},{key:"setOrderPayment",value:function setOrderPayment(e,t){this.order[e]=t,this.validatePayment()}},{key:"setOrderContacts",value:function setOrderContacts(e,t){this.order[e]=t,this.validateContacts()}},{key:"validatePayment",value:function validatePayment(){var e=Object.assign({},this.formErrors);String(this.order.payment||"").trim()?delete e.payment:e.payment="Выберите способ оплаты",String(this.order.address||"").trim()?delete e.address:e.address="Введите адрес доставки",this.formErrors=e,this.events.emit("formErrorsOrder:change",{errors:this.formErrors})}},{key:"validateContacts",value:function validateContacts(){var e=Object.assign({},this.formErrors);String(this.order.phone||"").trim()?delete e.payment:e.payment="Введите свой номер телефона",String(this.order.email||"").trim()?delete e.address:e.address="Введите свою электронную почту",this.formErrors=e,this.events.emit("formErrorsContacts:change",{errors:this.formErrors})}}]),Order}();function baseView_typeof(e){return baseView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},baseView_typeof(e)}function baseView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function baseView_toPrimitive(e,t){if("object"!==baseView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==baseView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===baseView_typeof(i)?i:String(i)),o)}var n,i}var c=function(){function Component(e){!function baseView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Component),this.element=e}return function baseView_createClass(e,t,r){return t&&baseView_defineProperties(e.prototype,t),r&&baseView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Component,[{key:"toggleClass",value:function toggleClass(e){return this.element.classList.toggle(e),this}},{key:"setText",value:function setText(e){return function isEmpty(e){return null==e}(e)||(this.element instanceof HTMLImageElement?this.element.alt=e:this.element.textContent=e),this}},{key:"setDisable",value:function setDisable(e){return(this.element instanceof HTMLButtonElement||this.element instanceof HTMLInputElement||this.element instanceof HTMLSelectElement)&&(this.element.disabled=e),this}},{key:"setHidden",value:function setHidden(e){return this.element.hidden=e,this}},{key:"setVisible",value:function setVisible(e,t){return this.element.style.display=e?t||"block":"none",this}},{key:"setImage",value:function setImage(e){return this.element instanceof HTMLImageElement&&(this.element.src=e),this}},{key:"render",value:function render(e){return this.element}}]),Component}();function page_typeof(e){return page_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},page_typeof(e)}function page_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function page_toPrimitive(e,t){if("object"!==page_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==page_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===page_typeof(i)?i:String(i)),o)}var n,i}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function _possibleConstructorReturn(e,t){if(t&&("object"===page_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var u=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(Page,e);var t=_createSuper(Page);function Page(e,r){var o;return function page_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Page),(o=t.call(this,e)).events=r,o.elementCounter=o.element.querySelector(".header__basket-counter"),o.buttonBascket=o.element.querySelector(".header__basket"),o.galleryCard=o.element.querySelector(".gallery"),o.buttonBascket.addEventListener("click",(function(){o.events.emit("basket:open")})),o}return function page_createClass(e,t,r){return t&&page_defineProperties(e.prototype,t),r&&page_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Page,[{key:"setBasketCounter",value:function setBasketCounter(e){this.elementCounter.textContent=String(e)}},{key:"setLocked",value:function setLocked(e){this.element.style.overflow=e?"hidden":"visible"}}]),Page}(c);function modal_typeof(e){return modal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},modal_typeof(e)}function modal_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function modal_toPrimitive(e,t){if("object"!==modal_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==modal_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===modal_typeof(i)?i:String(i)),o)}var n,i}var s=function(){function Modal(e,t){var r=this;!function modal_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Modal),this.modal=e,this.events=t,this.content=this.modal.querySelector(".modal__content"),this.modal.querySelector(".modal__close").addEventListener("click",(function(){r.events.emit("modal:close")})),this.modal.addEventListener("click",(function(e){e.target===r.modal&&r.events.emit("modal:close")}))}return function modal_createClass(e,t,r){return t&&modal_defineProperties(e.prototype,t),r&&modal_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Modal,[{key:"open",value:function open(){this.modal.classList.add("modal_active")}},{key:"close",value:function close(){this.modal.classList.remove("modal_active")}},{key:"setContent",value:function setContent(e){return this.clearContent(),this.content.appendChild(e),this}},{key:"clearContent",value:function clearContent(){this.content.innerHTML=""}}]),Modal}();function basket_typeof(e){return basket_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},basket_typeof(e)}function basket_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function basket_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function basket_toPrimitive(e,t){if("object"!==basket_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==basket_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===basket_typeof(i)?i:String(i)),o)}var n,i}function basket_createClass(e,t,r){return t&&basket_defineProperties(e.prototype,t),r&&basket_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function basket_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&basket_setPrototypeOf(e,t)}function basket_setPrototypeOf(e,t){return basket_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},basket_setPrototypeOf(e,t)}function basket_createSuper(e){var t=function basket_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=basket_getPrototypeOf(e);if(t){var n=basket_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function basket_possibleConstructorReturn(e,t){if(t&&("object"===basket_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function basket_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function basket_getPrototypeOf(e){return basket_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},basket_getPrototypeOf(e)}var l=function(e){basket_inherits(Basket,e);var t=basket_createSuper(Basket);function Basket(e,r){var o;return basket_classCallCheck(this,Basket),(o=t.call(this,e)).events=r,o.list=o.element.querySelector(".basket__list"),o.orderButton=o.element.querySelector(".basket__button"),o.total=o.element.querySelector(".basket__price"),o.orderButton.addEventListener("click",(function(){o.events.emit("basket:submit")})),o}return basket_createClass(Basket,[{key:"listStatus",value:function listStatus(e){e?(this.list.style.opacity="1",this.orderButton.disabled=!1):(this.list.textContent="Корзина пуста",this.list.style.opacity="0.3",this.orderButton.disabled=!0)}},{key:"setTotal",value:function setTotal(e){this.total.textContent=e+" синапсов"}}]),Basket}(c),f=function(e){basket_inherits(BasketItem,e);var t=basket_createSuper(BasketItem);function BasketItem(e,r){var o;return basket_classCallCheck(this,BasketItem),(o=t.call(this,e)).events=r,o.count=o.element.querySelector(".basket__item-index"),o.title=o.element.querySelector(".card__title"),o.price=o.element.querySelector(".card__price"),o.deleteButton=o.element.querySelector(".basket__item-delete"),o.deleteButton.addEventListener("click",(function(){o.element.remove(),o.events.emit("product:removeBasket",{id:o.itemId})})),o}return basket_createClass(BasketItem,[{key:"setCounter",value:function setCounter(e){this.count.textContent=String(e)}},{key:"render",value:function render(e){return e&&(this.itemId=e.id,this.title.textContent=e.title,e.price?this.price.textContent=e.price+" синапсов":this.price.textContent="Бесценно"),this.element}}]),BasketItem}(c);function productCard_typeof(e){return productCard_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},productCard_typeof(e)}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(e,t,r){var o=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=productCard_getPrototypeOf(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},_get.apply(this,arguments)}function productCard_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function productCard_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function productCard_toPrimitive(e,t){if("object"!==productCard_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==productCard_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===productCard_typeof(i)?i:String(i)),o)}var n,i}function productCard_createClass(e,t,r){return t&&productCard_defineProperties(e.prototype,t),r&&productCard_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function productCard_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&productCard_setPrototypeOf(e,t)}function productCard_setPrototypeOf(e,t){return productCard_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},productCard_setPrototypeOf(e,t)}function productCard_createSuper(e){var t=function productCard_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=productCard_getPrototypeOf(e);if(t){var n=productCard_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function productCard_possibleConstructorReturn(e,t){if(t&&("object"===productCard_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function productCard_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function productCard_getPrototypeOf(e){return productCard_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},productCard_getPrototypeOf(e)}var p=function(e){productCard_inherits(ProductCardView,e);var t=productCard_createSuper(ProductCardView);function ProductCardView(e,r){var o;return productCard_classCallCheck(this,ProductCardView),(o=t.call(this,e)).events=r,o.category=o.element.querySelector(".card__category"),o.title=o.element.querySelector(".card__title"),o.image=o.element.querySelector(".card__image"),o.price=o.element.querySelector(".card__price"),o.element.addEventListener("click",(function(){o.events.emit("product:open",{id:o.itemId})})),o}return productCard_createClass(ProductCardView,[{key:"render",value:function render(e){return e&&(this.itemId=e.id,this.category.textContent=e.category,this.title.textContent=e.title,this.image.src=n+""+e.image,e.price?this.price.textContent=e.price+" синапсов":this.price.textContent="Бесценно"),this.element}}]),ProductCardView}(c),y=function(e){productCard_inherits(ProductCardPreView,e);var t=productCard_createSuper(ProductCardPreView);function ProductCardPreView(e,r){var o;return productCard_classCallCheck(this,ProductCardPreView),(o=t.call(this,e,r)).productInBasket=!1,o.description=o.element.querySelector(".card__text"),o.button=o.element.querySelector(".card__button"),o.button.addEventListener("click",(function(){o.productInBasket=!o.productInBasket,o.buttonStatus(o.productInBasket),o.events.emit("product:addBasket",{id:o.itemId})})),o}return productCard_createClass(ProductCardPreView,[{key:"buttonStatus",value:function buttonStatus(e){this.button.textContent=e?"Удалить из корзины":"В корзину"}},{key:"disabledButton",value:function disabledButton(e){this.button.disabled=e}},{key:"render",value:function render(e){return _get(productCard_getPrototypeOf(ProductCardPreView.prototype),"render",this).call(this,e),e&&(this.description.textContent=e.description,null===e.price&&this.disabledButton(!0)),this.element}}]),ProductCardPreView}(p);function form_typeof(e){return form_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},form_typeof(e)}function form_get(){return form_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(e,t,r){var o=function form_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=form_getPrototypeOf(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},form_get.apply(this,arguments)}function form_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function form_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function form_toPrimitive(e,t){if("object"!==form_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==form_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===form_typeof(i)?i:String(i)),o)}var n,i}function form_createClass(e,t,r){return t&&form_defineProperties(e.prototype,t),r&&form_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function form_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&form_setPrototypeOf(e,t)}function form_setPrototypeOf(e,t){return form_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},form_setPrototypeOf(e,t)}function form_createSuper(e){var t=function form_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=form_getPrototypeOf(e);if(t){var n=form_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function form_possibleConstructorReturn(e,t){if(t&&("object"===form_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function form_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function form_getPrototypeOf(e){return form_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},form_getPrototypeOf(e)}var d=function(e){form_inherits(Form,e);var t=form_createSuper(Form);function Form(e,r){var o;return form_classCallCheck(this,Form),(o=t.call(this,e)).events=r,o.submit=o.element.querySelector(".modal__actions"),o.element.addEventListener("input",(function(e){var t=e.target;t&&t.name&&o.onInputChange(t.name,t.value)})),o}return form_createClass(Form,[{key:"disableButton",value:function disableButton(e,t){e.disabled=t}},{key:"reset",value:function reset(){this.element.reset()}},{key:"onInputChange",value:function onInputChange(e,t){this.events.emit("order.".concat(e,":change"),{value:t})}},{key:"render",value:function render(){return this.element}}]),Form}(c),m=function(e){form_inherits(FormPayment,e);var t=form_createSuper(FormPayment);function FormPayment(e,r){var o;return form_classCallCheck(this,FormPayment),(o=t.call(this,e,r)).paymentButtons=e.querySelectorAll(".button_alt"),o.orderButton=e.querySelector(".order__button"),o.orderButton.addEventListener("click",(function(){o.events.emit("order:submit")})),o.paymentButtons.forEach((function(e){e.addEventListener("click",(function(){o.selected=e.name,o.paymentButtons.forEach((function(e){return e.classList.remove("button_alt-active")})),e.classList.add("button_alt-active"),o.onInputChange("payment",o.selected)}))})),o}return form_createClass(FormPayment,[{key:"reset",value:function reset(){form_get(form_getPrototypeOf(FormPayment.prototype),"reset",this).call(this),this.selected=""}}]),FormPayment}(d),b=function(e){form_inherits(FormContacts,e);var t=form_createSuper(FormContacts);function FormContacts(e,r){var o;return form_classCallCheck(this,FormContacts),(o=t.call(this,e,r)).button=e.querySelector(".button"),o.button.addEventListener("click",(function(){o.events.emit("contacts:submit")})),o}return form_createClass(FormContacts)}(d),v=function(e){form_inherits(FormSuccess,e);var t=form_createSuper(FormSuccess);function FormSuccess(e,r){var o;return form_classCallCheck(this,FormSuccess),(o=t.call(this,e)).events=r,o.total=o.element.querySelector(".order-success__description"),o.element.querySelector(".order-success__close").addEventListener("click",(function(){o.events.emit("modal:close")})),o}return form_createClass(FormSuccess,[{key:"render",value:function render(e){return this.total.textContent="Списанно ".concat(e.total," синапсов"),this.element}}]),FormSuccess}(c);function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return src_arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function src_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return src_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return src_arrayLikeToArray(e,t)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function src_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var _=document.querySelector("#card-catalog").content,h=document.querySelector("#card-preview").content,g=document.querySelector("#basket").content,P=document.querySelector("#card-basket").content,C=document.querySelector("#order").content,k=document.querySelector("#contacts").content,S=document.querySelector("#success").content,O=document.querySelector(".page"),w=document.querySelector(".modal"),j=g.querySelector(".basket"),E=C.querySelector(".form"),T=k.querySelector(".form"),B=S.querySelector(".order-success");E.addEventListener("submit",(function(e){e.preventDefault()}));var I=new e(o),q=new t,L=new r(I),R=new i(q),A=new u(O,q),x=new s(w,q),V=new l(j,q),F=new m(E,q),N=new b(T,q),M=new v(B,q),D=new a(q);L.productList().then((function(e){R.setItemList(e)})),q.on("productList:changed",(function(e){var t;(t=A.galleryCard).replaceChildren.apply(t,_toConsumableArray(e.map((function(e){var t=_.querySelector(".card").cloneNode(!0);return new p(t,q).render(e)}))))})),q.on("product:open",(function(e){var t=h.querySelector(".card").cloneNode(!0),r=new y(t,q),o=R.getItem(e);D.hasProduct(e)&&r.buttonStatus(!0),q.emit("modal:open",r.render(o))})),q.on("modal:open",(function(e){x.setContent(e).open(),A.setLocked(!0)})),q.on("modal:close",(function(){x.close(),A.setLocked(!1)})),q.on("basket:open",(function(){var e=D.items;V.setTotal(D.getTotal());var t,r=1;e.length>0?(V.listStatus(!0),(t=V.list).replaceChildren.apply(t,_toConsumableArray(e.map((function(e){var t=P.querySelector(".card").cloneNode(!0),o=new f(t,q);return o.setCounter(r),r++,o.render(e)}))))):V.listStatus(!1);q.emit("modal:open",V.render())})),q.on("product:addBasket",(function(e){var t=R.getItem(e),r={id:t.id,title:t.title,price:t.price};D.hasProduct(e)?q.emit("product:removeBasket",e):(D.addProduct(r),A.setBasketCounter(D.items.length),V.setTotal(D.getTotal()))})),q.on("product:removeBasket",(function(e){D.removeProduct(e),A.setBasketCounter(D.items.length),q.emit("basket:open")})),q.on("basket:submit",(function(){D.order.items=D.items.map((function(e){return e.id})),D.order.total=D.getTotal(),q.emit("modal:open",F.render())})),q.on("order.payment:change",(function(e){D.setOrderPayment("payment",e.value)})),q.on("order.address:change",(function(e){D.setOrderPayment("address",e.value)})),q.on("formErrorsOrder:change",(function(e){0==Object.keys(e.errors).length?(E.querySelector(".form__errors").textContent="",F.disableButton(E.querySelector(".order__button"),!1)):(E.querySelector(".form__errors").textContent=Object.keys(e.errors).map((function(t){return e.errors[t]})).join(", "),F.disableButton(E.querySelector(".order__button"),!0))})),q.on("order:submit",(function(){q.emit("modal:open",N.render())})),q.on("order.email:change",(function(e){D.setOrderContacts("email",e.value)})),q.on("order.phone:change",(function(e){D.setOrderContacts("phone",e.value)})),q.on("formErrorsContacts:change",(function(e){0==Object.keys(e.errors).length?(T.querySelector(".form__errors").textContent="",N.disableButton(T.querySelector(".button"),!1)):(T.querySelector(".form__errors").textContent=Object.keys(e.errors).map((function(t){return e.errors[t]})).join(", "),N.disableButton(T.querySelector(".button"),!0))})),q.on("contacts:submit",(function(){L.orderProduct(D.order),q.emit("modal:open",M.render({total:D.getTotal()}))}))})();
//# sourceMappingURL=main.js.map